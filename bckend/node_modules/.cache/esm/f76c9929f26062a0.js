let FAQS,GLOBALS,site_metric;_f26‍.x([["add_faq",()=>add_faq],["update_faq",()=>update_faq],["remove_faq",()=>remove_faq],["faqs",()=>faqs]]);_f26‍.w("../ds/conn",[["FAQS",["FAQS"],function(v){FAQS=v}],["GLOBALS",["GLOBALS"],function(v){GLOBALS=v}]]);_f26‍.w("./starter",[["site_metric",["site_metric"],function(v){site_metric=v}]]);


const add_faq = (req, res) => {
  let result = FAQS.write(req.body);

  GLOBALS.update({ global: site_metric }, { faqs: { $inc: 1 } });

  res.json({
    ok: true,
    message: "faq added",
    data: { _id: result._id, created: result.created },
  });
};

const update_faq = (req, res) => {
  let faq = req.body;

  let result = FAQS.update(faq._id, faq);

  res.json({
    ok: true,
    message: "faq added",
    data: { _id: result._id, created: result.created },
  });
};

const remove_faq = (req, res) => {
  let { faq } = req.params;

  FAQS.remove(faq);
  GLOBALS.update({ global: site_metric }, { faqs: { $dec: 1 } });

  res.end();
};

const faqs = (req, res) => {
  let { limit, skip } = req.body;

  res.json({
    ok: true,
    message: "faqs",
    data: FAQS.read(null, { limit: Number(limit), skip: Number(skip) }),
  });
};


